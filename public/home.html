<!DOCTYPE html>
<html lang="en">
<head>
    <script src="/config.js"></script>
    <!-- Basic HTML5 document setup -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EverCart - Your One-Stop Shopping Destination</title>
    
    <!-- External stylesheets -->
    <link rel="stylesheet" href="styles.css">
    
    <!-- Google Fonts for enhanced typography -->
    <link href="https://fonts.googleapis.com/css?family=Pacifico&display=swap" rel="stylesheet">
    <!-- 
    =====================================================
    HOME PAGE SPECIFIC STYLES
    =====================================================
    
    This section contains CSS styles specific to the homepage.
    Includes:
    - Header navigation styling
    - Hero section layout
    - Category showcase grid
    - Featured products section
    - Promotional banners
    - Footer styling
    - Responsive design for mobile devices
    -->
    <style>
        /* ==================== HEADER STYLES ==================== */
        .main-header {
            display: flex;
            align-items: center;
            background: linear-gradient(90deg, #2575fc 0%, #6a11cb 100%);
            padding: 0.5em 2em;
            color: #fff;
            font-family: 'Segoe UI', Arial, sans-serif;
        }
        .main-header h1 {
            margin: 0;
            font-size: 2rem;
            font-weight: 700;
        }
        .nav-links {
            display: flex;
            gap: 2em;
            margin-left: 2em;
        }
        .nav-links a {
            color: #fff;
            text-decoration: none;
            font-weight: 500;
            font-size: 1.1rem;
            transition: color 0.2s;
        }
        .nav-links a:hover {
            color: #ffd700;
        }
        .header-actions {
            margin-left: auto;
            display: flex;
            align-items: center;
            gap: 1.2em;
        }
        .icon-btn {
            background: none;
            border: none;
            cursor: pointer;
            padding: 0.3em;
            border-radius: 50%;
            transition: background 0.2s;
            display: flex;
            align-items: center;
        }
        .icon-btn:hover {
            background: rgba(255,255,255,0.15);
        }
        .icon {
            width: 28px;
            height: 28px;
            fill: #fff;
        }
        .cart-count {
            background: #e74c3c;
            color: #fff;
            border-radius: 50%;
            font-size: 0.85em;
            padding: 2px 7px;
            position: absolute;
            top: 0;
            right: -8px;
        }
        .header-actions .icon-btn {
            position: relative;
        }
        .main-footer {
            background: linear-gradient(90deg, #2575fc 0%, #6a11cb 100%);
            color: #fff;
            padding: 2em 0 1em 0;
            margin-top: 3em;
            font-family: 'Segoe UI', Arial, sans-serif;
        }
        .footer-content {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-around;
            max-width: 1200px;
            margin: 0 auto;
            gap: 2em;
        }
        .footer-section {
            flex: 1 1 200px;
            min-width: 200px;
            margin-bottom: 1em;
        }
        .footer-section h3, .footer-section h4 {
            margin-top: 0;
            margin-bottom: 0.7em;
            font-weight: 700;
        }
        .footer-section ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        .footer-section ul li {
            margin-bottom: 0.5em;
        }
        .footer-section ul a {
            color: #fff;
            text-decoration: none;
            transition: color 0.2s;
        }
        .footer-section ul a:hover {
            color: #ffd700;
        }
        .footer-social a {
            margin-right: 1em;
            display: inline-block;
            vertical-align: middle;
        }
        .footer-bottom {
            text-align: center;
            margin-top: 1em;
            font-size: 0.95em;
            opacity: 0.8;
        }
        /* ==================== RESPONSIVE DESIGN ==================== */
        @media (max-width: 800px) {
            .footer-content {
                flex-direction: column;
                align-items: center;
                gap: 1.5em;
            }
            .footer-section {
                min-width: 0;
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <header class="main-header">
        <h1><a href="home.html" style="color: white; text-decoration: none;">EverCart</a></h1>
        <nav class="nav-links">
            <a href="home.html">Home</a>
            <a href="index.html">Shop</a>
            <a href="blog.html">Blog</a>
            <a href="about.html">About</a>
            <a href="faq.html">FAQ</a>
            <a href="contact.html">Contact</a>
        </nav>
        <div class="header-actions">
            <!-- Admin Access Link -->
            <button class="icon-btn" onclick="window.location.href='admin-login.html'" title="Admin Panel" style="background: linear-gradient(135deg, #e74c3c, #c0392b); border-radius: 8px; padding: 0.4em 0.8em;">
                <svg class="icon" viewBox="0 0 24 24" style="width: 20px; height: 20px;">
                    <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                </svg>
            </button>
            <!-- User/Login Icon -->
            <button class="icon-btn" onclick="window.location.href='login.html'" title="Login / Sign Up">
                <svg class="icon" viewBox="0 0 24 24">
                    <circle cx="12" cy="8" r="4"/>
                    <path d="M4 20c0-4 8-4 8-4s8 0 8 4"/>
                </svg>
            </button>
            <!-- Cart Icon -->
            <button class="icon-btn" onclick="window.location.href='cart.html'" title="Cart">
                <svg class="icon" viewBox="0 0 24 24">
                    <path d="M6 6h15l-1.5 9h-13z"/>
                    <circle cx="9" cy="21" r="1.5"/>
                    <circle cx="18" cy="21" r="1.5"/>
                </svg>
                <span id="cart-count" class="cart-count" style="display:none;">0</span>
            </button>
        </div>
    </header>
    <!-- ==================== MAIN CONTENT ==================== -->
    <main class="home-main">
        <!-- Hero section with main tagline and call-to-action -->
        <section class="hero-section">
            <div class="hero-content">
                <h1>"Shop Smart ! Shop EverCart"</h1>
                <h2>Discover Your Next Favorite Product!</h2>
                <p>Explore a world of electronics, household essentials, daily usage items, and more.</p>
                <a href="index.html" class="shop-now-button">Shop All Products</a>
            </div>
        </section>

        <!-- Category showcase section - dynamically loaded categories -->
        <section class="category-showcase">
            <h2>Shop by Category</h2>
            <!-- Category cards populated by JavaScript -->
            <div class="categories-grid" id="categories-grid">
                </div>
        </section>

        <!-- Featured products section - highlights top products -->
        <section class="featured-products">
            <h2>Featured Products</h2>
            <!-- Product grid populated by JavaScript (first 4 products) -->
            <div id="featured-products-grid" class="product-grid">
                </div>
        </section>

        <!-- Promotions section - marketing banners for special offers -->
        <section class="promotions-section">
            <h2>Limited Time Offers!</h2>
            <!-- First promotional offer -->
            <div class="promotion-card">
                <h3>Free Shipping on Orders Over $75</h3>
                <p>No code needed. Applies automatically.</p>
                <a href="index.html" class="promo-button">Start Shopping</a>
            </div>
            <!-- Second promotional offer -->
            <div class="promotion-card">
                <h3>Free Shipping on Orders Over $75</h3>
                <p>No code needed. Applies automatically.</p>
                <a href="index.html" class="promo-button">Start Shopping</a>
            </div>
        </section>
    </main>


    <!-- 
    =====================================================
    HOMEPAGE DYNAMIC CONTENT SCRIPT
    =====================================================
    
    This script handles:
    1. Loading and displaying product categories
    2. Showing featured products (first 4 products)
    3. Search functionality redirection
    4. Category card click navigation
    -->
    <script>
    document.addEventListener('DOMContentLoaded', async () => {
        // DOM element references
        const categoriesGrid = document.getElementById('categories-grid');
        const featuredProductsGrid = document.getElementById('featured-products-grid');
        const productSearchHomeInput = document.getElementById('product-search-home');
        const searchButtonHome = document.getElementById('search-button-home');

        // ==================== API FUNCTIONS ====================
        
        /**
         * Fetch all products from the backend API
         * @returns {Promise<Array>} Array of product objects
         */
        async function fetchProducts() {
            const res = await fetch('http://localhost:3000/api/products');
            return await res.json();
        }

        /**
         * Fetch unique product categories from the backend API
         * @returns {Promise<Array>} Array of category strings
         */
        async function fetchCategories() {
            const res = await fetch('http://localhost:3000/api/categories');
            return await res.json();
        }

        // ==================== RENDERING FUNCTIONS ====================
        
        /**
         * Render category cards on the homepage
         * - Fetches categories and products
         * - Creates clickable category cards
         * - Uses first product image from each category as thumbnail
         * - Links to shop page with category filter
         */
        async function renderCategoryCards() {
            const categories = await fetchCategories();
            const products = await fetchProducts();
            categoriesGrid.innerHTML = ''; // Clear existing content
            
            categories.forEach(category => {
                // Find a product from this category to use its image
                const categoryProduct = products.find(p => p.category === category);
                const categoryImage = categoryProduct ? categoryProduct.image : 'https://via.placeholder.com/200/CCCCCC/000000?text=Category';
                
                // Create clickable category card
                const categoryCard = document.createElement('a');
                categoryCard.href = `index.html?category=${encodeURIComponent(category)}`;
                categoryCard.classList.add('category-card');
                categoryCard.innerHTML = `
                    <img src="${categoryImage}" alt="${category}">
                    <h3>${category}</h3>
                `;
                categoriesGrid.appendChild(categoryCard);
            });
        }

        /**
         * Render featured products section
         * - Shows first 4 products as featured items
         * - Displays product image, name, description, and price
         * - Cards are not clickable (view-only for homepage)
         */
        async function renderFeaturedProducts() {
            const products = await fetchProducts();
            const featured = products.slice(0, 4); // Take first 4 products
            featuredProductsGrid.innerHTML = ''; // Clear existing content
            
            featured.forEach(product => {
                const div = document.createElement('div');
                div.className = 'product-card';
                div.innerHTML = `
                    <img src="${product.image}" alt="${product.name}">
                    <h3>${product.name}</h3>
                    <p>${product.description}</p>
                    <span>$${product.price}</span>
                `;
                featuredProductsGrid.appendChild(div);
            });
        }

        // ==================== INITIALIZATION ====================
        // Load content when page loads
        renderCategoryCards();
        renderFeaturedProducts();

        // ==================== EVENT HANDLERS ====================
        
        /**
         * Handle search button click
         * - Redirects to shop page with search query
         * - If no search term, shows all products
         */
        searchButtonHome?.addEventListener('click', () => {
            const searchTerm = productSearchHomeInput.value;
            if (searchTerm) {
                window.location.href = `index.html?search=${encodeURIComponent(searchTerm)}`;
            } else {
                window.location.href = `index.html`;
            }
        });

        /**
         * Handle Enter key press in search input
         * - Triggers search when user presses Enter
         */
        productSearchHomeInput?.addEventListener('keyup', (event) => {
            if (event.key === 'Enter') {
                searchButtonHome.click();
            }
        });
    });
    </script>
    <!-- 
    =====================================================
    CART COUNT DISPLAY SCRIPT
    =====================================================
    
    This script handles:
    1. Checking if user is logged in
    2. Fetching cart item count from backend
    3. Displaying cart badge with item count
    4. Hiding badge if cart is empty or user not logged in
    -->
    <script>
    document.addEventListener('DOMContentLoaded', async () => {
        const cartCountSpan = document.getElementById('cart-count');
        const user = JSON.parse(localStorage.getItem('user')); // Get logged-in user
        
        if (user) {
            // User is logged in, fetch their cart count
            try {
                const res = await fetch(`http://localhost:3000/api/cart?userEmail=${encodeURIComponent(user.email)}`);
                const cart = await res.json();
                
                // Calculate total items in cart
                const count = cart.items ? cart.items.reduce((sum, item) => sum + item.quantity, 0) : 0;
                
                if (count > 0) {
                    // Show cart badge with item count
                    cartCountSpan.textContent = count;
                    cartCountSpan.style.display = 'inline-block';
                }
            } catch (e) {
                // Hide cart badge on error
                cartCountSpan.style.display = 'none';
            }
        }
        // If user not logged in, cart badge remains hidden by default
    });
    </script>
    <!-- ==================== FOOTER SECTION ==================== -->
    <!-- 
    Footer contains:
    - Brand information and description
    - Quick navigation links
    - Contact information
    - Social media links
    - Copyright notice
    -->
    <footer class="main-footer">
        <div class="footer-content">
            <!-- Brand information -->
            <div class="footer-section">
                <h3>EverCart</h3>
                <p>Your one-stop shop for electronics, fashion, and daily essentials. Enjoy fast delivery and great deals every day!</p>
            </div>
            <!-- Navigation links -->
            <div class="footer-section">
                <h4>Quick Links</h4>
                <ul>
                    <li><a href="home.html">Home</a></li>
                    <li><a href="index.html">Shop</a></li>
                    <li><a href="blog.html">Blog</a></li>
                    <li><a href="about.html">About</a></li>
                    <li><a href="faq.html">FAQ</a></li>
                    <li><a href="contact.html">Contact</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h4>Contact</h4>
                <p>Email: support@evercart.com</p>
                <p>Phone: +91-9876543210</p>
                <p>Address: 123 EverCart Lane, New Delhi, India</p>
            </div>
            <div class="footer-section">
                <h4>Follow Us</h4>
                <div class="footer-social">
                    <a href="#" title="Instagram"><img src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/instagram.svg" alt="Instagram" style="width:24px;height:24px;filter:invert(50%)"></a>
                    <a href="#" title="Facebook"><img src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/facebook.svg" alt="Facebook" style="width:24px;height:24px;filter:invert(50%)"></a>
                    <a href="#" title="Twitter"><img src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/twitter.svg" alt="Twitter" style="width:24px;height:24px;filter:invert(50%)"></a>
                </div>
            </div>
        </div>
        <div class="footer-bottom">
            &copy; 2025 EverCart. All rights reserved.
        </div>
    </footer>
</body>
</html>
